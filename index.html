<!DOCTYPE html>
<html>
<head>
  <title>Checkout</title>
  <meta charset="UTF-8" />
</head>

<body>
  <h2>Checkout</h2>

  <label>Name</label><br>
  <input id="name" placeholder="Your name"><br><br>

  <label>Amount (ZMW)</label><br>
  <input id="amount" type="number" value="50"><br><br>

  <button id="pay" type="button">Pay Now</button>


  <p id="status"></p>

<script>
document.getElementById("pay").addEventListener("click", async () => {
  const status = document.getElementById("status");

  status.textContent = "Creating payment...";

  const body = {
    name: document.getElementById("name").value,
    amount: Number(document.getElementById("amount").value)
  };

  try {
    const res = await fetch("/api/checkout", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(body)
    });

    const data = await res.json();
    console.log(data);

    if (data.redirectUrl) {
      status.textContent = "Redirecting to payment...";
      window.location.href = data.redirectUrl;
    } else {
      status.textContent = "Could not start payment.";
    }

  } catch (e) {
    status.textContent = "Error creating payment.";
    console.error(e);
  }
});
</script>

</body>
</html>
